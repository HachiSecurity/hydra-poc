<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><meta name="viewport" content="width=device-width, initial-scale=1" /><title>Hydra.Chain.Direct.Wallet</title><link href="linuwial.css" rel="stylesheet" type="text/css" title="Linuwial" /><link rel="stylesheet" type="text/css" href="quick-jump.css" /><link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=PT+Sans:400,400i,700" /><script src="haddock-bundle.min.js" async="async" type="text/javascript"></script><script type="text/x-mathjax-config">MathJax.Hub.Config({ tex2jax: { processClass: "mathjax", ignoreClass: ".*" } });</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script></head><body><div id="package-header"><span class="caption">hydra-node-0.1.0: The Hydra node</span><ul class="links" id="page-menu"><li><a href="index.html">Contents</a></li><li><a href="doc-index.html">Index</a></li></ul></div><div id="content"><div id="module-header"><table class="info"><tr><th>Safe Haskell</th><td>None</td></tr><tr><th>Language</th><td>Haskell2010</td></tr></table><p class="caption">Hydra.Chain.Direct.Wallet</p></div><div id="description"><p class="caption">Description</p><div class="doc"><p>Companion tiny-wallet for the direct chain component. This module provide
 some useful utilities to tracking the wallet's UTXO, and accessing it</p></div></div><div id="synopsis"><details id="syn"><summary>Synopsis</summary><ul class="details-toggle" data-details-id="syn"><li class="src short"><span class="keyword">type</span> <a href="#t:Address">Address</a> = Addr StandardCrypto</li><li class="src short"><span class="keyword">type</span> <a href="#t:TxBody">TxBody</a> = TxBody <a href="Hydra-Chain-Direct-Util.html#t:Era" title="Hydra.Chain.Direct.Util">Era</a></li><li class="src short"><span class="keyword">type</span> <a href="#t:VerificationKey">VerificationKey</a> = VerKeyDSIGN (DSIGN StandardCrypto)</li><li class="src short"><span class="keyword">type</span> <a href="#t:SigningKey">SigningKey</a> = SignKeyDSIGN (DSIGN StandardCrypto)</li><li class="src short"><span class="keyword">type</span> <a href="#t:TxIn">TxIn</a> = TxIn StandardCrypto</li><li class="src short"><span class="keyword">type</span> <a href="#t:TxOut">TxOut</a> = TxOut <a href="Hydra-Chain-Direct-Util.html#t:Era" title="Hydra.Chain.Direct.Util">Era</a></li><li class="src short"><span class="keyword">type</span> <a href="#t:VkWitness">VkWitness</a> = WitVKey 'Witness StandardCrypto</li><li class="src short"><span class="keyword">type</span> <a href="#t:QueryResult">QueryResult</a> result = <a href="file:///home/runner/work/hydra-poc/hydra-poc/dist-newstyle/build/x86_64-linux/ghc-8.10.4/hydra-prelude-0.1.0/doc/html/hydra-prelude/Hydra-Prelude.html#t:Either" title="Hydra.Prelude">Either</a> (MismatchEraInfo (CardanoEras StandardCrypto)) result</li><li class="src short"><span class="keyword">type</span> <a href="#t:UtxoSet">UtxoSet</a> = UTxO <a href="Hydra-Chain-Direct-Util.html#t:Era" title="Hydra.Chain.Direct.Util">Era</a></li><li class="src short"><span class="keyword">type</span> <a href="#t:AlonzoPoint">AlonzoPoint</a> = Point (ShelleyBlock <a href="Hydra-Chain-Direct-Util.html#t:Era" title="Hydra.Chain.Direct.Util">Era</a>)</li><li class="src short"><span class="keyword">data</span> <a href="#t:TinyWallet">TinyWallet</a> m = <a href="#v:TinyWallet">TinyWallet</a> {<ul class="subs"><li><a href="#v:getUtxo">getUtxo</a> :: <a href="file:///home/runner/work/hydra-poc/hydra-poc/dist-newstyle/build/x86_64-linux/ghc-8.10.4/hydra-prelude-0.1.0/doc/html/hydra-prelude/Hydra-Prelude.html#t:STM" title="Hydra.Prelude">STM</a> m (<a href="file:///home/runner/work/hydra-poc/hydra-poc/dist-newstyle/build/x86_64-linux/ghc-8.10.4/hydra-prelude-0.1.0/doc/html/hydra-prelude/Hydra-Prelude.html#t:Map" title="Hydra.Prelude">Map</a> <a href="Hydra-Chain-Direct-Wallet.html#t:TxIn" title="Hydra.Chain.Direct.Wallet">TxIn</a> <a href="Hydra-Chain-Direct-Wallet.html#t:TxOut" title="Hydra.Chain.Direct.Wallet">TxOut</a>)</li><li><a href="#v:getAddress">getAddress</a> :: <a href="Hydra-Chain-Direct-Wallet.html#t:Address" title="Hydra.Chain.Direct.Wallet">Address</a></li><li><a href="#v:sign">sign</a> :: <a href="Hydra-Chain-Direct-Wallet.html#t:TxBody" title="Hydra.Chain.Direct.Wallet">TxBody</a> -&gt; <a href="Hydra-Chain-Direct-Wallet.html#t:VkWitness" title="Hydra.Chain.Direct.Wallet">VkWitness</a></li><li><a href="#v:coverFee">coverFee</a> :: <a href="Hydra-Chain-Direct-Wallet.html#t:TxBody" title="Hydra.Chain.Direct.Wallet">TxBody</a> -&gt; <a href="file:///home/runner/work/hydra-poc/hydra-poc/dist-newstyle/build/x86_64-linux/ghc-8.10.4/hydra-prelude-0.1.0/doc/html/hydra-prelude/Hydra-Prelude.html#t:STM" title="Hydra.Prelude">STM</a> m (<a href="file:///home/runner/work/hydra-poc/hydra-poc/dist-newstyle/build/x86_64-linux/ghc-8.10.4/hydra-prelude-0.1.0/doc/html/hydra-prelude/Hydra-Prelude.html#t:Either" title="Hydra.Prelude">Either</a> <a href="Hydra-Chain-Direct-Wallet.html#t:ErrCoverFee" title="Hydra.Chain.Direct.Wallet">ErrCoverFee</a> <a href="Hydra-Chain-Direct-Wallet.html#t:TxBody" title="Hydra.Chain.Direct.Wallet">TxBody</a>)</li></ul>}</li><li class="src short"><a href="#v:withTinyWallet">withTinyWallet</a> :: <a href="Hydra-Chain-Direct.html#t:NetworkMagic" title="Hydra.Chain.Direct">NetworkMagic</a> -&gt; (<a href="Hydra-Chain-Direct-Wallet.html#t:VerificationKey" title="Hydra.Chain.Direct.Wallet">VerificationKey</a>, <a href="Hydra-Chain-Direct-Wallet.html#t:SigningKey" title="Hydra.Chain.Direct.Wallet">SigningKey</a>) -&gt; IOManager -&gt; <a href="file:///home/runner/work/hydra-poc/hydra-poc/dist-newstyle/build/x86_64-linux/ghc-8.10.4/hydra-prelude-0.1.0/doc/html/hydra-prelude/Hydra-Prelude.html#t:FilePath" title="Hydra.Prelude">FilePath</a> -&gt; (<a href="Hydra-Chain-Direct-Wallet.html#t:TinyWallet" title="Hydra.Chain.Direct.Wallet">TinyWallet</a> <a href="file:///home/runner/work/hydra-poc/hydra-poc/dist-newstyle/build/x86_64-linux/ghc-8.10.4/hydra-prelude-0.1.0/doc/html/hydra-prelude/Hydra-Prelude.html#t:IO" title="Hydra.Prelude">IO</a> -&gt; <a href="file:///home/runner/work/hydra-poc/hydra-poc/dist-newstyle/build/x86_64-linux/ghc-8.10.4/hydra-prelude-0.1.0/doc/html/hydra-prelude/Hydra-Prelude.html#t:IO" title="Hydra.Prelude">IO</a> ()) -&gt; <a href="file:///home/runner/work/hydra-poc/hydra-poc/dist-newstyle/build/x86_64-linux/ghc-8.10.4/hydra-prelude-0.1.0/doc/html/hydra-prelude/Hydra-Prelude.html#t:IO" title="Hydra.Prelude">IO</a> ()</li><li class="src short"><a href="#v:applyBlock">applyBlock</a> :: <a href="Hydra-Chain-Direct-Util.html#t:Block" title="Hydra.Chain.Direct.Util">Block</a> -&gt; (<a href="Hydra-Chain-Direct-Wallet.html#t:Address" title="Hydra.Chain.Direct.Wallet">Address</a> -&gt; <a href="file:///home/runner/work/hydra-poc/hydra-poc/dist-newstyle/build/x86_64-linux/ghc-8.10.4/hydra-prelude-0.1.0/doc/html/hydra-prelude/Hydra-Prelude.html#t:Bool" title="Hydra.Prelude">Bool</a>) -&gt; <a href="file:///home/runner/work/hydra-poc/hydra-poc/dist-newstyle/build/x86_64-linux/ghc-8.10.4/hydra-prelude-0.1.0/doc/html/hydra-prelude/Hydra-Prelude.html#t:Map" title="Hydra.Prelude">Map</a> <a href="Hydra-Chain-Direct-Wallet.html#t:TxIn" title="Hydra.Chain.Direct.Wallet">TxIn</a> <a href="Hydra-Chain-Direct-Wallet.html#t:TxOut" title="Hydra.Chain.Direct.Wallet">TxOut</a> -&gt; <a href="file:///home/runner/work/hydra-poc/hydra-poc/dist-newstyle/build/x86_64-linux/ghc-8.10.4/hydra-prelude-0.1.0/doc/html/hydra-prelude/Hydra-Prelude.html#t:Map" title="Hydra.Prelude">Map</a> <a href="Hydra-Chain-Direct-Wallet.html#t:TxIn" title="Hydra.Chain.Direct.Wallet">TxIn</a> <a href="Hydra-Chain-Direct-Wallet.html#t:TxOut" title="Hydra.Chain.Direct.Wallet">TxOut</a></li><li class="src short"><span class="keyword">data</span> <a href="#t:ErrCoverFee">ErrCoverFee</a><ul class="subs"><li>= <a href="#v:ErrNoAvailableUtxo">ErrNoAvailableUtxo</a></li><li>| <a href="#v:ErrNotEnoughFunds">ErrNotEnoughFunds</a> { <ul class="subs"><li><a href="#v:missingDelta">missingDelta</a> :: Coin</li></ul> }</li></ul></li><li class="src short"><a href="#v:coverFee_">coverFee_</a> :: <a href="file:///home/runner/work/hydra-poc/hydra-poc/dist-newstyle/build/x86_64-linux/ghc-8.10.4/hydra-prelude-0.1.0/doc/html/hydra-prelude/Hydra-Prelude.html#t:Map" title="Hydra.Prelude">Map</a> <a href="Hydra-Chain-Direct-Wallet.html#t:TxIn" title="Hydra.Chain.Direct.Wallet">TxIn</a> <a href="Hydra-Chain-Direct-Wallet.html#t:TxOut" title="Hydra.Chain.Direct.Wallet">TxOut</a> -&gt; <a href="Hydra-Chain-Direct-Wallet.html#t:TxBody" title="Hydra.Chain.Direct.Wallet">TxBody</a> -&gt; <a href="file:///home/runner/work/hydra-poc/hydra-poc/dist-newstyle/build/x86_64-linux/ghc-8.10.4/hydra-prelude-0.1.0/doc/html/hydra-prelude/Hydra-Prelude.html#t:Either" title="Hydra.Prelude">Either</a> <a href="Hydra-Chain-Direct-Wallet.html#t:ErrCoverFee" title="Hydra.Chain.Direct.Wallet">ErrCoverFee</a> <a href="Hydra-Chain-Direct-Wallet.html#t:TxBody" title="Hydra.Chain.Direct.Wallet">TxBody</a></li><li class="src short"><a href="#v:client">client</a> :: (<a href="file:///home/runner/work/hydra-poc/hydra-poc/dist-newstyle/build/x86_64-linux/ghc-8.10.4/hydra-prelude-0.1.0/doc/html/hydra-prelude/Hydra-Prelude.html#t:MonadST" title="Hydra.Prelude">MonadST</a> m, <a href="file:///home/runner/work/hydra-poc/hydra-poc/dist-newstyle/build/x86_64-linux/ghc-8.10.4/hydra-prelude-0.1.0/doc/html/hydra-prelude/Hydra-Prelude.html#t:MonadTimer" title="Hydra.Prelude">MonadTimer</a> m) =&gt; <a href="file:///home/runner/work/hydra-poc/hydra-poc/dist-newstyle/build/x86_64-linux/ghc-8.10.4/hydra-prelude-0.1.0/doc/html/hydra-prelude/Hydra-Prelude.html#t:TVar" title="Hydra.Prelude">TVar</a> m (Point <a href="Hydra-Chain-Direct-Util.html#t:Block" title="Hydra.Chain.Direct.Util">Block</a>) -&gt; <a href="file:///home/runner/work/hydra-poc/hydra-poc/dist-newstyle/build/x86_64-linux/ghc-8.10.4/hydra-prelude-0.1.0/doc/html/hydra-prelude/Hydra-Prelude.html#t:TMVar" title="Hydra.Prelude">TMVar</a> m (<a href="file:///home/runner/work/hydra-poc/hydra-poc/dist-newstyle/build/x86_64-linux/ghc-8.10.4/hydra-prelude-0.1.0/doc/html/hydra-prelude/Hydra-Prelude.html#t:Map" title="Hydra.Prelude">Map</a> <a href="Hydra-Chain-Direct-Wallet.html#t:TxIn" title="Hydra.Chain.Direct.Wallet">TxIn</a> <a href="Hydra-Chain-Direct-Wallet.html#t:TxOut" title="Hydra.Chain.Direct.Wallet">TxOut</a>) -&gt; <a href="Hydra-Chain-Direct-Wallet.html#t:Address" title="Hydra.Chain.Direct.Wallet">Address</a> -&gt; NodeToClientVersion -&gt; OuroborosApplication 'InitiatorMode LocalAddress <a href="file:///home/runner/work/hydra-poc/hydra-poc/dist-newstyle/build/x86_64-linux/ghc-8.10.4/hydra-prelude-0.1.0/doc/html/hydra-prelude/Hydra-Prelude.html#t:LByteString" title="Hydra.Prelude">LByteString</a> m () <a href="file:///home/runner/work/hydra-poc/hydra-poc/dist-newstyle/build/x86_64-linux/ghc-8.10.4/hydra-prelude-0.1.0/doc/html/hydra-prelude/Hydra-Prelude.html#t:Void" title="Hydra.Prelude">Void</a></li><li class="src short"><a href="#v:chainSyncClient">chainSyncClient</a> :: <span class="keyword">forall</span> m. <a href="file:///home/runner/work/hydra-poc/hydra-poc/dist-newstyle/build/x86_64-linux/ghc-8.10.4/hydra-prelude-0.1.0/doc/html/hydra-prelude/Hydra-Prelude.html#t:MonadSTM" title="Hydra.Prelude">MonadSTM</a> m =&gt; <a href="file:///home/runner/work/hydra-poc/hydra-poc/dist-newstyle/build/x86_64-linux/ghc-8.10.4/hydra-prelude-0.1.0/doc/html/hydra-prelude/Hydra-Prelude.html#t:TVar" title="Hydra.Prelude">TVar</a> m (Point <a href="Hydra-Chain-Direct-Util.html#t:Block" title="Hydra.Chain.Direct.Util">Block</a>) -&gt; <a href="file:///home/runner/work/hydra-poc/hydra-poc/dist-newstyle/build/x86_64-linux/ghc-8.10.4/hydra-prelude-0.1.0/doc/html/hydra-prelude/Hydra-Prelude.html#t:TMVar" title="Hydra.Prelude">TMVar</a> m (<a href="file:///home/runner/work/hydra-poc/hydra-poc/dist-newstyle/build/x86_64-linux/ghc-8.10.4/hydra-prelude-0.1.0/doc/html/hydra-prelude/Hydra-Prelude.html#t:Map" title="Hydra.Prelude">Map</a> <a href="Hydra-Chain-Direct-Wallet.html#t:TxIn" title="Hydra.Chain.Direct.Wallet">TxIn</a> <a href="Hydra-Chain-Direct-Wallet.html#t:TxOut" title="Hydra.Chain.Direct.Wallet">TxOut</a>) -&gt; <a href="Hydra-Chain-Direct-Wallet.html#t:Address" title="Hydra.Chain.Direct.Wallet">Address</a> -&gt; ChainSyncClient <a href="Hydra-Chain-Direct-Util.html#t:Block" title="Hydra.Chain.Direct.Util">Block</a> (Point <a href="Hydra-Chain-Direct-Util.html#t:Block" title="Hydra.Chain.Direct.Util">Block</a>) (Tip <a href="Hydra-Chain-Direct-Util.html#t:Block" title="Hydra.Chain.Direct.Util">Block</a>) m ()</li><li class="src short"><a href="#v:stateQueryClient">stateQueryClient</a> :: <span class="keyword">forall</span> m. (<a href="file:///home/runner/work/hydra-poc/hydra-poc/dist-newstyle/build/x86_64-linux/ghc-8.10.4/hydra-prelude-0.1.0/doc/html/hydra-prelude/Hydra-Prelude.html#t:MonadSTM" title="Hydra.Prelude">MonadSTM</a> m, <a href="file:///home/runner/work/hydra-poc/hydra-poc/dist-newstyle/build/x86_64-linux/ghc-8.10.4/hydra-prelude-0.1.0/doc/html/hydra-prelude/Hydra-Prelude.html#t:MonadTimer" title="Hydra.Prelude">MonadTimer</a> m) =&gt; <a href="file:///home/runner/work/hydra-poc/hydra-poc/dist-newstyle/build/x86_64-linux/ghc-8.10.4/hydra-prelude-0.1.0/doc/html/hydra-prelude/Hydra-Prelude.html#t:TVar" title="Hydra.Prelude">TVar</a> m (Point <a href="Hydra-Chain-Direct-Util.html#t:Block" title="Hydra.Chain.Direct.Util">Block</a>) -&gt; <a href="file:///home/runner/work/hydra-poc/hydra-poc/dist-newstyle/build/x86_64-linux/ghc-8.10.4/hydra-prelude-0.1.0/doc/html/hydra-prelude/Hydra-Prelude.html#t:TMVar" title="Hydra.Prelude">TMVar</a> m (<a href="file:///home/runner/work/hydra-poc/hydra-poc/dist-newstyle/build/x86_64-linux/ghc-8.10.4/hydra-prelude-0.1.0/doc/html/hydra-prelude/Hydra-Prelude.html#t:Map" title="Hydra.Prelude">Map</a> <a href="Hydra-Chain-Direct-Wallet.html#t:TxIn" title="Hydra.Chain.Direct.Wallet">TxIn</a> <a href="Hydra-Chain-Direct-Wallet.html#t:TxOut" title="Hydra.Chain.Direct.Wallet">TxOut</a>) -&gt; <a href="Hydra-Chain-Direct-Wallet.html#t:Address" title="Hydra.Chain.Direct.Wallet">Address</a> -&gt; LocalStateQueryClient <a href="Hydra-Chain-Direct-Util.html#t:Block" title="Hydra.Chain.Direct.Util">Block</a> (Point <a href="Hydra-Chain-Direct-Util.html#t:Block" title="Hydra.Chain.Direct.Util">Block</a>) (Query <a href="Hydra-Chain-Direct-Util.html#t:Block" title="Hydra.Chain.Direct.Util">Block</a>) m ()</li></ul></details></div><div id="interface"><h1>Documentation</h1><div class="top"><p class="src"><span class="keyword">type</span> <a id="t:Address" class="def">Address</a> = Addr StandardCrypto <a href="#t:Address" class="selflink">#</a></p></div><div class="top"><p class="src"><span class="keyword">type</span> <a id="t:TxBody" class="def">TxBody</a> = TxBody <a href="Hydra-Chain-Direct-Util.html#t:Era" title="Hydra.Chain.Direct.Util">Era</a> <a href="#t:TxBody" class="selflink">#</a></p></div><div class="top"><p class="src"><span class="keyword">type</span> <a id="t:VerificationKey" class="def">VerificationKey</a> = VerKeyDSIGN (DSIGN StandardCrypto) <a href="#t:VerificationKey" class="selflink">#</a></p></div><div class="top"><p class="src"><span class="keyword">type</span> <a id="t:SigningKey" class="def">SigningKey</a> = SignKeyDSIGN (DSIGN StandardCrypto) <a href="#t:SigningKey" class="selflink">#</a></p></div><div class="top"><p class="src"><span class="keyword">type</span> <a id="t:TxIn" class="def">TxIn</a> = TxIn StandardCrypto <a href="#t:TxIn" class="selflink">#</a></p></div><div class="top"><p class="src"><span class="keyword">type</span> <a id="t:TxOut" class="def">TxOut</a> = TxOut <a href="Hydra-Chain-Direct-Util.html#t:Era" title="Hydra.Chain.Direct.Util">Era</a> <a href="#t:TxOut" class="selflink">#</a></p></div><div class="top"><p class="src"><span class="keyword">type</span> <a id="t:VkWitness" class="def">VkWitness</a> = WitVKey 'Witness StandardCrypto <a href="#t:VkWitness" class="selflink">#</a></p></div><div class="top"><p class="src"><span class="keyword">type</span> <a id="t:QueryResult" class="def">QueryResult</a> result = <a href="file:///home/runner/work/hydra-poc/hydra-poc/dist-newstyle/build/x86_64-linux/ghc-8.10.4/hydra-prelude-0.1.0/doc/html/hydra-prelude/Hydra-Prelude.html#t:Either" title="Hydra.Prelude">Either</a> (MismatchEraInfo (CardanoEras StandardCrypto)) result <a href="#t:QueryResult" class="selflink">#</a></p></div><div class="top"><p class="src"><span class="keyword">type</span> <a id="t:UtxoSet" class="def">UtxoSet</a> = UTxO <a href="Hydra-Chain-Direct-Util.html#t:Era" title="Hydra.Chain.Direct.Util">Era</a> <a href="#t:UtxoSet" class="selflink">#</a></p></div><div class="top"><p class="src"><span class="keyword">type</span> <a id="t:AlonzoPoint" class="def">AlonzoPoint</a> = Point (ShelleyBlock <a href="Hydra-Chain-Direct-Util.html#t:Era" title="Hydra.Chain.Direct.Util">Era</a>) <a href="#t:AlonzoPoint" class="selflink">#</a></p></div><div class="top"><p class="src"><span class="keyword">data</span> <a id="t:TinyWallet" class="def">TinyWallet</a> m <a href="#t:TinyWallet" class="selflink">#</a></p><div class="doc"><p>A <code><a href="Hydra-Chain-Direct-Wallet.html#t:TinyWallet" title="Hydra.Chain.Direct.Wallet">TinyWallet</a></code> is a small abstraction of a wallet with basic UTXO
 management. The wallet is assumed to have only one address, and only one
 UTXO at that address.</p><p>It can sign transactions and keeps track of its UTXO behind the scene.</p></div><div class="subs constructors"><p class="caption">Constructors</p><table><tr><td class="src"><a id="v:TinyWallet" class="def">TinyWallet</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><div class="subs fields"><p class="caption">Fields</p><ul><li><dfn class="src"><a id="v:getUtxo" class="def">getUtxo</a> :: <a href="file:///home/runner/work/hydra-poc/hydra-poc/dist-newstyle/build/x86_64-linux/ghc-8.10.4/hydra-prelude-0.1.0/doc/html/hydra-prelude/Hydra-Prelude.html#t:STM" title="Hydra.Prelude">STM</a> m (<a href="file:///home/runner/work/hydra-poc/hydra-poc/dist-newstyle/build/x86_64-linux/ghc-8.10.4/hydra-prelude-0.1.0/doc/html/hydra-prelude/Hydra-Prelude.html#t:Map" title="Hydra.Prelude">Map</a> <a href="Hydra-Chain-Direct-Wallet.html#t:TxIn" title="Hydra.Chain.Direct.Wallet">TxIn</a> <a href="Hydra-Chain-Direct-Wallet.html#t:TxOut" title="Hydra.Chain.Direct.Wallet">TxOut</a>)</dfn><div class="doc empty">&nbsp;</div></li><li><dfn class="src"><a id="v:getAddress" class="def">getAddress</a> :: <a href="Hydra-Chain-Direct-Wallet.html#t:Address" title="Hydra.Chain.Direct.Wallet">Address</a></dfn><div class="doc empty">&nbsp;</div></li><li><dfn class="src"><a id="v:sign" class="def">sign</a> :: <a href="Hydra-Chain-Direct-Wallet.html#t:TxBody" title="Hydra.Chain.Direct.Wallet">TxBody</a> -&gt; <a href="Hydra-Chain-Direct-Wallet.html#t:VkWitness" title="Hydra.Chain.Direct.Wallet">VkWitness</a></dfn><div class="doc empty">&nbsp;</div></li><li><dfn class="src"><a id="v:coverFee" class="def">coverFee</a> :: <a href="Hydra-Chain-Direct-Wallet.html#t:TxBody" title="Hydra.Chain.Direct.Wallet">TxBody</a> -&gt; <a href="file:///home/runner/work/hydra-poc/hydra-poc/dist-newstyle/build/x86_64-linux/ghc-8.10.4/hydra-prelude-0.1.0/doc/html/hydra-prelude/Hydra-Prelude.html#t:STM" title="Hydra.Prelude">STM</a> m (<a href="file:///home/runner/work/hydra-poc/hydra-poc/dist-newstyle/build/x86_64-linux/ghc-8.10.4/hydra-prelude-0.1.0/doc/html/hydra-prelude/Hydra-Prelude.html#t:Either" title="Hydra.Prelude">Either</a> <a href="Hydra-Chain-Direct-Wallet.html#t:ErrCoverFee" title="Hydra.Chain.Direct.Wallet">ErrCoverFee</a> <a href="Hydra-Chain-Direct-Wallet.html#t:TxBody" title="Hydra.Chain.Direct.Wallet">TxBody</a>)</dfn><div class="doc empty">&nbsp;</div></li></ul></div></td></tr></table></div></div><div class="top"><p class="src"><a id="v:withTinyWallet" class="def">withTinyWallet</a> <a href="#v:withTinyWallet" class="selflink">#</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: <a href="Hydra-Chain-Direct.html#t:NetworkMagic" title="Hydra.Chain.Direct">NetworkMagic</a></td><td class="doc"><p>Network identifier to which we expect to connect.</p></td></tr><tr><td class="src">-&gt; (<a href="Hydra-Chain-Direct-Wallet.html#t:VerificationKey" title="Hydra.Chain.Direct.Wallet">VerificationKey</a>, <a href="Hydra-Chain-Direct-Wallet.html#t:SigningKey" title="Hydra.Chain.Direct.Wallet">SigningKey</a>)</td><td class="doc"><p>Credentials of the wallet.</p></td></tr><tr><td class="src">-&gt; IOManager</td><td class="doc"><p>A cross-platform abstraction for managing I/O operations on local sockets</p></td></tr><tr><td class="src">-&gt; <a href="file:///home/runner/work/hydra-poc/hydra-poc/dist-newstyle/build/x86_64-linux/ghc-8.10.4/hydra-prelude-0.1.0/doc/html/hydra-prelude/Hydra-Prelude.html#t:FilePath" title="Hydra.Prelude">FilePath</a></td><td class="doc"><p>Path to a domain socket used to connect to the server.</p></td></tr><tr><td class="src">-&gt; (<a href="Hydra-Chain-Direct-Wallet.html#t:TinyWallet" title="Hydra.Chain.Direct.Wallet">TinyWallet</a> <a href="file:///home/runner/work/hydra-poc/hydra-poc/dist-newstyle/build/x86_64-linux/ghc-8.10.4/hydra-prelude-0.1.0/doc/html/hydra-prelude/Hydra-Prelude.html#t:IO" title="Hydra.Prelude">IO</a> -&gt; <a href="file:///home/runner/work/hydra-poc/hydra-poc/dist-newstyle/build/x86_64-linux/ghc-8.10.4/hydra-prelude-0.1.0/doc/html/hydra-prelude/Hydra-Prelude.html#t:IO" title="Hydra.Prelude">IO</a> ())</td><td class="doc empty">&nbsp;</td></tr><tr><td class="src">-&gt; <a href="file:///home/runner/work/hydra-poc/hydra-poc/dist-newstyle/build/x86_64-linux/ghc-8.10.4/hydra-prelude-0.1.0/doc/html/hydra-prelude/Hydra-Prelude.html#t:IO" title="Hydra.Prelude">IO</a> ()</td><td class="doc empty">&nbsp;</td></tr></table></div></div><div class="top"><p class="src"><a id="v:applyBlock" class="def">applyBlock</a> :: <a href="Hydra-Chain-Direct-Util.html#t:Block" title="Hydra.Chain.Direct.Util">Block</a> -&gt; (<a href="Hydra-Chain-Direct-Wallet.html#t:Address" title="Hydra.Chain.Direct.Wallet">Address</a> -&gt; <a href="file:///home/runner/work/hydra-poc/hydra-poc/dist-newstyle/build/x86_64-linux/ghc-8.10.4/hydra-prelude-0.1.0/doc/html/hydra-prelude/Hydra-Prelude.html#t:Bool" title="Hydra.Prelude">Bool</a>) -&gt; <a href="file:///home/runner/work/hydra-poc/hydra-poc/dist-newstyle/build/x86_64-linux/ghc-8.10.4/hydra-prelude-0.1.0/doc/html/hydra-prelude/Hydra-Prelude.html#t:Map" title="Hydra.Prelude">Map</a> <a href="Hydra-Chain-Direct-Wallet.html#t:TxIn" title="Hydra.Chain.Direct.Wallet">TxIn</a> <a href="Hydra-Chain-Direct-Wallet.html#t:TxOut" title="Hydra.Chain.Direct.Wallet">TxOut</a> -&gt; <a href="file:///home/runner/work/hydra-poc/hydra-poc/dist-newstyle/build/x86_64-linux/ghc-8.10.4/hydra-prelude-0.1.0/doc/html/hydra-prelude/Hydra-Prelude.html#t:Map" title="Hydra.Prelude">Map</a> <a href="Hydra-Chain-Direct-Wallet.html#t:TxIn" title="Hydra.Chain.Direct.Wallet">TxIn</a> <a href="Hydra-Chain-Direct-Wallet.html#t:TxOut" title="Hydra.Chain.Direct.Wallet">TxOut</a> <a href="#v:applyBlock" class="selflink">#</a></p><div class="doc"><p>Apply a block to our wallet. Does nothing if the transaction does not
 modify the UTXO set, or else, remove consumed utxos and add produced ones.</p><p>To determine whether a produced output is ours, we compare it to our unique
 address.</p></div></div><div class="top"><p class="src"><span class="keyword">data</span> <a id="t:ErrCoverFee" class="def">ErrCoverFee</a> <a href="#t:ErrCoverFee" class="selflink">#</a></p><div class="subs constructors"><p class="caption">Constructors</p><table><tr><td class="src"><a id="v:ErrNoAvailableUtxo" class="def">ErrNoAvailableUtxo</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a id="v:ErrNotEnoughFunds" class="def">ErrNotEnoughFunds</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><div class="subs fields"><p class="caption">Fields</p><ul><li><dfn class="src"><a id="v:missingDelta" class="def">missingDelta</a> :: Coin</dfn><div class="doc empty">&nbsp;</div></li></ul></div></td></tr></table></div><div class="subs instances"><h4 class="instances details-toggle-control details-toggle" data-details-id="i:ErrCoverFee">Instances</h4><details id="i:ErrCoverFee" open="open"><summary class="hide-when-js-enabled">Instances details</summary><table><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:id:ErrCoverFee:Show:1"></span> <a href="file:///home/runner/work/hydra-poc/hydra-poc/dist-newstyle/build/x86_64-linux/ghc-8.10.4/hydra-prelude-0.1.0/doc/html/hydra-prelude/Hydra-Prelude.html#t:Show" title="Hydra.Prelude">Show</a> <a href="Hydra-Chain-Direct-Wallet.html#t:ErrCoverFee" title="Hydra.Chain.Direct.Wallet">ErrCoverFee</a></span> <a href="#t:ErrCoverFee" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:id:ErrCoverFee:Show:1"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="Hydra-Chain-Direct-Wallet.html">Hydra.Chain.Direct.Wallet</a></p> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:showsPrec">showsPrec</a> :: <a href="file:///home/runner/work/hydra-poc/hydra-poc/dist-newstyle/build/x86_64-linux/ghc-8.10.4/hydra-prelude-0.1.0/doc/html/hydra-prelude/Hydra-Prelude.html#t:Int" title="Hydra.Prelude">Int</a> -&gt; <a href="Hydra-Chain-Direct-Wallet.html#t:ErrCoverFee" title="Hydra.Chain.Direct.Wallet">ErrCoverFee</a> -&gt; ShowS</p><p class="src"><a href="#v:show">show</a> :: <a href="Hydra-Chain-Direct-Wallet.html#t:ErrCoverFee" title="Hydra.Chain.Direct.Wallet">ErrCoverFee</a> -&gt; <a href="file:///home/runner/work/hydra-poc/hydra-poc/dist-newstyle/build/x86_64-linux/ghc-8.10.4/hydra-prelude-0.1.0/doc/html/hydra-prelude/Hydra-Prelude.html#t:String" title="Hydra.Prelude">String</a></p><p class="src"><a href="#v:showList">showList</a> :: [<a href="Hydra-Chain-Direct-Wallet.html#t:ErrCoverFee" title="Hydra.Chain.Direct.Wallet">ErrCoverFee</a>] -&gt; ShowS</p></div></details></td></tr></table></details></div></div><div class="top"><p class="src"><a id="v:coverFee_" class="def">coverFee_</a> :: <a href="file:///home/runner/work/hydra-poc/hydra-poc/dist-newstyle/build/x86_64-linux/ghc-8.10.4/hydra-prelude-0.1.0/doc/html/hydra-prelude/Hydra-Prelude.html#t:Map" title="Hydra.Prelude">Map</a> <a href="Hydra-Chain-Direct-Wallet.html#t:TxIn" title="Hydra.Chain.Direct.Wallet">TxIn</a> <a href="Hydra-Chain-Direct-Wallet.html#t:TxOut" title="Hydra.Chain.Direct.Wallet">TxOut</a> -&gt; <a href="Hydra-Chain-Direct-Wallet.html#t:TxBody" title="Hydra.Chain.Direct.Wallet">TxBody</a> -&gt; <a href="file:///home/runner/work/hydra-poc/hydra-poc/dist-newstyle/build/x86_64-linux/ghc-8.10.4/hydra-prelude-0.1.0/doc/html/hydra-prelude/Hydra-Prelude.html#t:Either" title="Hydra.Prelude">Either</a> <a href="Hydra-Chain-Direct-Wallet.html#t:ErrCoverFee" title="Hydra.Chain.Direct.Wallet">ErrCoverFee</a> <a href="Hydra-Chain-Direct-Wallet.html#t:TxBody" title="Hydra.Chain.Direct.Wallet">TxBody</a> <a href="#v:coverFee_" class="selflink">#</a></p><div class="doc"><p>Cover fee for a transaction body using the given UTXO set. This calculate
 necessary fees and augments inputs <em> outputs </em> collateral accordingly to
 cover for the transaction cost and get the change back.</p><p>TODO: The fee calculation is currently very dumb and static.</p></div></div><div class="top"><p class="src"><a id="v:client" class="def">client</a> :: (<a href="file:///home/runner/work/hydra-poc/hydra-poc/dist-newstyle/build/x86_64-linux/ghc-8.10.4/hydra-prelude-0.1.0/doc/html/hydra-prelude/Hydra-Prelude.html#t:MonadST" title="Hydra.Prelude">MonadST</a> m, <a href="file:///home/runner/work/hydra-poc/hydra-poc/dist-newstyle/build/x86_64-linux/ghc-8.10.4/hydra-prelude-0.1.0/doc/html/hydra-prelude/Hydra-Prelude.html#t:MonadTimer" title="Hydra.Prelude">MonadTimer</a> m) =&gt; <a href="file:///home/runner/work/hydra-poc/hydra-poc/dist-newstyle/build/x86_64-linux/ghc-8.10.4/hydra-prelude-0.1.0/doc/html/hydra-prelude/Hydra-Prelude.html#t:TVar" title="Hydra.Prelude">TVar</a> m (Point <a href="Hydra-Chain-Direct-Util.html#t:Block" title="Hydra.Chain.Direct.Util">Block</a>) -&gt; <a href="file:///home/runner/work/hydra-poc/hydra-poc/dist-newstyle/build/x86_64-linux/ghc-8.10.4/hydra-prelude-0.1.0/doc/html/hydra-prelude/Hydra-Prelude.html#t:TMVar" title="Hydra.Prelude">TMVar</a> m (<a href="file:///home/runner/work/hydra-poc/hydra-poc/dist-newstyle/build/x86_64-linux/ghc-8.10.4/hydra-prelude-0.1.0/doc/html/hydra-prelude/Hydra-Prelude.html#t:Map" title="Hydra.Prelude">Map</a> <a href="Hydra-Chain-Direct-Wallet.html#t:TxIn" title="Hydra.Chain.Direct.Wallet">TxIn</a> <a href="Hydra-Chain-Direct-Wallet.html#t:TxOut" title="Hydra.Chain.Direct.Wallet">TxOut</a>) -&gt; <a href="Hydra-Chain-Direct-Wallet.html#t:Address" title="Hydra.Chain.Direct.Wallet">Address</a> -&gt; NodeToClientVersion -&gt; OuroborosApplication 'InitiatorMode LocalAddress <a href="file:///home/runner/work/hydra-poc/hydra-poc/dist-newstyle/build/x86_64-linux/ghc-8.10.4/hydra-prelude-0.1.0/doc/html/hydra-prelude/Hydra-Prelude.html#t:LByteString" title="Hydra.Prelude">LByteString</a> m () <a href="file:///home/runner/work/hydra-poc/hydra-poc/dist-newstyle/build/x86_64-linux/ghc-8.10.4/hydra-prelude-0.1.0/doc/html/hydra-prelude/Hydra-Prelude.html#t:Void" title="Hydra.Prelude">Void</a> <a href="#v:client" class="selflink">#</a></p><div class="doc"><p>The idea for this wallet client is rather simple:</p><ol><li>We bootstrap the client using the Local State Query (abbrev. LSQ) protocol,
 and in particular the <code>GetUTxO</code> query to get the most recent UTxO at the tip.</li></ol><p>This request is however quite costly (O(n) in the size of the ledger's UTXO).
 So we don't want to poll it too often and burn needless CPU resources. Plus,
 whatever poll value we choose, we'll always end up report outdated
 information. Thus,</p><ol><li>Once the most recent tip and UTXO acquired, we give the baton from the LSQ
 to the chain-sync protocol, which can continue watching the chain from that
 point on such that, if the UTXO is ever spent, it'll replace it with its new
 UTXO (reminder: the wallet has only one address).</li></ol><p>Then, there's a bit of error-handling because, it's possible that between the
 moment we acquire the tip with the LSQ and pass the relay to the chain-sync,
 the chain has rolled back and the tip is no longer available. This can be
 gracefully done via waiting on MVars. See below.</p><p>The MVar also provides a convenient interface for the `TinyWallet m`
 abstraction which is used by consumers downstreams.</p></div></div><div class="top"><p class="src"><a id="v:chainSyncClient" class="def">chainSyncClient</a> :: <span class="keyword">forall</span> m. <a href="file:///home/runner/work/hydra-poc/hydra-poc/dist-newstyle/build/x86_64-linux/ghc-8.10.4/hydra-prelude-0.1.0/doc/html/hydra-prelude/Hydra-Prelude.html#t:MonadSTM" title="Hydra.Prelude">MonadSTM</a> m =&gt; <a href="file:///home/runner/work/hydra-poc/hydra-poc/dist-newstyle/build/x86_64-linux/ghc-8.10.4/hydra-prelude-0.1.0/doc/html/hydra-prelude/Hydra-Prelude.html#t:TVar" title="Hydra.Prelude">TVar</a> m (Point <a href="Hydra-Chain-Direct-Util.html#t:Block" title="Hydra.Chain.Direct.Util">Block</a>) -&gt; <a href="file:///home/runner/work/hydra-poc/hydra-poc/dist-newstyle/build/x86_64-linux/ghc-8.10.4/hydra-prelude-0.1.0/doc/html/hydra-prelude/Hydra-Prelude.html#t:TMVar" title="Hydra.Prelude">TMVar</a> m (<a href="file:///home/runner/work/hydra-poc/hydra-poc/dist-newstyle/build/x86_64-linux/ghc-8.10.4/hydra-prelude-0.1.0/doc/html/hydra-prelude/Hydra-Prelude.html#t:Map" title="Hydra.Prelude">Map</a> <a href="Hydra-Chain-Direct-Wallet.html#t:TxIn" title="Hydra.Chain.Direct.Wallet">TxIn</a> <a href="Hydra-Chain-Direct-Wallet.html#t:TxOut" title="Hydra.Chain.Direct.Wallet">TxOut</a>) -&gt; <a href="Hydra-Chain-Direct-Wallet.html#t:Address" title="Hydra.Chain.Direct.Wallet">Address</a> -&gt; ChainSyncClient <a href="Hydra-Chain-Direct-Util.html#t:Block" title="Hydra.Chain.Direct.Util">Block</a> (Point <a href="Hydra-Chain-Direct-Util.html#t:Block" title="Hydra.Chain.Direct.Util">Block</a>) (Tip <a href="Hydra-Chain-Direct-Util.html#t:Block" title="Hydra.Chain.Direct.Util">Block</a>) m () <a href="#v:chainSyncClient" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:stateQueryClient" class="def">stateQueryClient</a> :: <span class="keyword">forall</span> m. (<a href="file:///home/runner/work/hydra-poc/hydra-poc/dist-newstyle/build/x86_64-linux/ghc-8.10.4/hydra-prelude-0.1.0/doc/html/hydra-prelude/Hydra-Prelude.html#t:MonadSTM" title="Hydra.Prelude">MonadSTM</a> m, <a href="file:///home/runner/work/hydra-poc/hydra-poc/dist-newstyle/build/x86_64-linux/ghc-8.10.4/hydra-prelude-0.1.0/doc/html/hydra-prelude/Hydra-Prelude.html#t:MonadTimer" title="Hydra.Prelude">MonadTimer</a> m) =&gt; <a href="file:///home/runner/work/hydra-poc/hydra-poc/dist-newstyle/build/x86_64-linux/ghc-8.10.4/hydra-prelude-0.1.0/doc/html/hydra-prelude/Hydra-Prelude.html#t:TVar" title="Hydra.Prelude">TVar</a> m (Point <a href="Hydra-Chain-Direct-Util.html#t:Block" title="Hydra.Chain.Direct.Util">Block</a>) -&gt; <a href="file:///home/runner/work/hydra-poc/hydra-poc/dist-newstyle/build/x86_64-linux/ghc-8.10.4/hydra-prelude-0.1.0/doc/html/hydra-prelude/Hydra-Prelude.html#t:TMVar" title="Hydra.Prelude">TMVar</a> m (<a href="file:///home/runner/work/hydra-poc/hydra-poc/dist-newstyle/build/x86_64-linux/ghc-8.10.4/hydra-prelude-0.1.0/doc/html/hydra-prelude/Hydra-Prelude.html#t:Map" title="Hydra.Prelude">Map</a> <a href="Hydra-Chain-Direct-Wallet.html#t:TxIn" title="Hydra.Chain.Direct.Wallet">TxIn</a> <a href="Hydra-Chain-Direct-Wallet.html#t:TxOut" title="Hydra.Chain.Direct.Wallet">TxOut</a>) -&gt; <a href="Hydra-Chain-Direct-Wallet.html#t:Address" title="Hydra.Chain.Direct.Wallet">Address</a> -&gt; LocalStateQueryClient <a href="Hydra-Chain-Direct-Util.html#t:Block" title="Hydra.Chain.Direct.Util">Block</a> (Point <a href="Hydra-Chain-Direct-Util.html#t:Block" title="Hydra.Chain.Direct.Util">Block</a>) (Query <a href="Hydra-Chain-Direct-Util.html#t:Block" title="Hydra.Chain.Direct.Util">Block</a>) m () <a href="#v:stateQueryClient" class="selflink">#</a></p></div></div></div><div id="footer"><p>Produced by <a href="http://www.haskell.org/haddock/">Haddock</a> version 2.24.0</p></div></body></html>